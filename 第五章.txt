存储系统是由几个容量、速度和价格各不相同的存储器构成的系统。
设计一个容量大、速度快、成本低的存储系统是计算机发展的一个重要课题。
5.1 存储系统的组成 
5.1.1 存储器分类
1.按存储器在计算机系统中的作用分类
  (1)高速缓冲存储器
  (2)主存储器
  (3)辅助存储器
2.按存取方式分类
  (1)随机存取存储器RAM
  (2)只读存储器ROM
  (3)顺序存取存储器SAM
  (4)直接存取存储器DAM
3.按存储介质分类
  (1)磁芯存储器
  (2)半导体存储器
  (3)磁表面存储器
  (4)光存储器
4.按信息的可保存性分类
  (1)易失性存储器
  (2)非易失性存储器
(断电后，存储信息即消失的存储器，称易失性存储器。断电后信息仍然保存的存储器，称非易失性存储器。)
如果某个存储单元所存储的信息被读出时，原存信息将被破坏，则称破坏性读出。具有破坏性读出的存储器，每当一次读出操作之后，必须紧接一个重写（再生）的操作，以便恢复被破坏的信息。
如果读出时，被读单元原存信息不被破坏，则称非破坏性读出。

5.1.2 存储系统层次结构
  为了解决存储容量、存取速度和价格之间的矛盾，通常把各种不同存储容量、不同存取速度的存储器，
按一定的体系结构组织起来，形成一个统一整体的存储系统。

由高速缓冲存储器、主存储器、辅助存储器构成的三级存储系统可以分为两个层次。
其中高速缓存和主存间称为Cache-主存存储层次（Cache存储系统）；
主存-辅存存储层次（虚拟存储系统）。

Cache系统是为解决主存速度不足而提出来的。
在Cache和主存之间，增加辅助硬件，让它们构成一个整体。从CPU看，速度接近Cache的速度，容量是主存的容量，每位价格接近于主存的价格。由于Cache存储系统全部用硬件来调度，因此它对系统程序员和应用程序员都是透明的。 

虚拟存储系统是为解决主存容量不足而提出来的。
在主存和辅存之间，增加辅助的软硬件，让它们构成一个整体。从CPU看，速度接近主存的速度，容量是虚拟的地址空间。虚拟存储系统需要通过操作系统来调度，对系统程序员是不透明的，但对应用程序员是透明的

5.2 主存储器的组织
主存储器是整个存储系统的核心，它用来存放计算机运行期间所需要的程序和数据，CPU可直接随机地对它进行访问。
主存储器通常由存储体、地址译码驱动电路、I/O和读写电路组成。

・存储体是主存储器的核心，程序和数据都存放在存储体中。 
・地址译码驱动电路实际上包含译码器和驱动器两部分。译码器将地址总线输入的地址码转换成与之对应的译码输出线上的有效电平，以表示选中了某一单元，并由驱动器提供驱动电流去驱动相应的读、写电路，完成对被选中单元的读、写操作。
・I/O和读写电路包括读出放大器、写入电路和读/写控制电路，用以完成被选中存储单元中各位的读出和写入操作。
存储器的读/写操作是在控制器的控制下进行的。半导体存储器芯片中的控制电路，必须接收到来自控制器的读/写命令或写入允许信号后，才能实现正确的读/写操作。


5.2.2 主存储器的存储单元

・位
・存储字
・存储单元或主存单元。
・存储体
存储单元是CPU对主存可访问操作的最小存储单位。

小端方案。假设字地址为N，则字节B3、B2、B1、B0依次存放在地址为N+3、N+2、N+1、N+0的存储单元，即字地址等于最低有效字节地址。采用小端方案的计算机有Intel 80X86、DEC VAX等。
图 (b)称为大端方案。假设字地址为N，则字节B3、B2、B1、B0依次存放在地址为N+0、N+1、N+2、N+3的存储单元，即字地址等于最高有效字节地址。采用大端方案的计算机有IBM360/370、Motorola 68000等。

5.2.3 主存储器的主要技术指标
1.存储容量
      存储容量是指主存所能容纳的二进制信息总量。对于字节编址的计算机，以字节数来表示容量；对于字编址的计算机，以字数与其字长的乘积来表示容量。
      如某计算机的容量为64K×16，表示它有64K个字，每个字的字长为16位，若用字节数表示，则可记为128K字节（128KB）。

2.存取速度
   ⑴存取时间Ta 
          存取时间又称为访问时间或读/写时间，它是指从启动一次存储器操作到完成该操作所经历的时间。
   ⑵存取周期Tm
          存取周期又可称作读写周期、访存周期，它是指存储器进行一次完整的读写操作所需的全部时间，即连续两次访问存储器操作之间所需要的最短时间。 

对于破坏性读出的存储器，存取周期往往比存取时间要大得多，甚至可以达到Tm＝2Ta，这是因为存储器中的信息读出后需要马上进行重写（再生）。


为了提高主存的带宽，可以采取的措施有：
      ・缩短存取周期；
      ・增加存储字长；
	   ・增加存储体。 

5.2.4 数据在主存中的存放
      在采用字节编址的情况下，数据在主存储器中的三种不同存放方法。假设，存储字为64位。

⑶边界对齐的数据存放方法
双字地址的最末三个二进制位必须为000，单字地址的最末两位必须为00，半字地址的最末一位必须为0。它能够保证无论访问双字、单字、半字或字节，都在一个存取周期内完成，尽管存储器资源仍然有浪费，但是浪费比第⑵种存放方法要少得多。

边界对齐的数据存放方法中，双字地址是8的倍数，单字地址是4的倍数，半字地址是2的倍数。

5.3 半导体随机存储器和只读存储器
主存储器通常分为RAM和ROM两大部分。RAM可读可写，ROM只能读不能写。

5.3.1 RAM记忆单元电路
存放一个二进制位的物理器件称为记忆单元，它是存储器的最基本构件，地址码相同的多个记忆单元构成一个存储单元。。

5.3.1 RAM记忆单元电路
   	 ・记忆单元可以由各种材料制成，但最常见的由MOS电路组成。MOS型存储器根据记忆单元的结构又可分为静态RAM和动态RAM两种。
	 ・静态RAM，即SRAM（Static RAM），其存储电路以双稳态触发器为基础；
	 ・动态RAM，即DRAM（Dynamic RAM），其存储电路以电容为基础
5.3.2 动态RAM的刷新
1.刷新间隔
	・为了维持MOS型动态记忆单元的存储信息，每隔一定时间必须对存储体中的所有记忆单元的栅极电容补充电荷，这个过程就是刷新。
  	・ 一般选定MOS型动态存储器允许的最大刷新间隔为2ms，也就是说，应在2ms内，将全部存储体刷新一遍。


・刷新和重写（再生）是两个完全不同的概念，切不可加以混淆。
  重写是随机的，某个存储单元只有在破坏性读出之后才需要重写。
  刷新是定时的，即使许多记忆单元长期未被访问，若不及时补充电荷的话，信息也会丢失。
  重写一般是按存储单元进行的
  刷新通常以存储体矩阵中的一行为单位进行的。
2.刷新方式
    集中式
        ・刷新时间=存储体矩阵行数×刷新周期
    分散式
	・分散刷新是指把刷新操作分散到每个存取周期内进行，此时系统的存取周期被分为两部分，前一部分时间进行读/写操作或保持，后一部分时间进行刷新操作。一个系统存取周期内刷新存储矩阵中的一行。

    异步式
        ・异步刷新方式可以看成前述两种方式的结合，它充分利用了最大刷新间隔时间，把刷新操作平均分配到整个最大刷新间隔时间内进行，故有：
    相邻两行的刷新间隔=最大刷新间隔时间/行数
3.刷新控制
   MOS型动态RAM的刷新要注意几个问题：
    ① 刷新对CPU是透明的。
    ② 刷新通常是一行一行地进行的。
    ③ 刷新操作类似于读出操作。
    ④ 所有芯片同时被刷新。

5.3.3 RAM芯片分析
1.RAM芯片
    ・存储芯片通过地址线（AB）、数据线（DB）和控制线（CB）与外部连接。
    ・地址线（AB）是单向输入的，其数目与芯片容量有关。如容量为1024×4时，地址线有10根；容量为64K×1时，地址线有16根。
1.RAM芯片
    ・控制线（CB）主要有读/写控制线（或写允许线）和片选线两种，读/写控制线是用来决定芯片是进行读操作还是写操作的，片选线是用来决定该芯片是否被选中的。
    ・由于DRAM芯片采用了地址复用技术，因此，DRAM芯片每增加一条地址线，实际上是增加了两位地址，也即增加了4倍的容量。

5.3.4  半导体只读存储器（ROM）
1.ROM的类型
(1)掩膜式ROM（MROM）
(2)一次可编程ROM（PROM）
(3)可擦除可编程ROM（EPROM）
   UVEPROM（紫外线擦除）
   EEPROM（电擦除）
(4)闪速存储器（flash memory）


5.4.1 主存容量的扩展
・要组成一个主存，首先要考虑选片的问题，然后就是如何把芯片连接起来的问题。
根据存储器所要求的容量和选定的存储芯片的容量，就可以计算出总的芯片数

1.位扩展
位扩展指只在位数方向扩展（加大字长），而芯片的字数和存储器的字数是一致的。。
 如用64K×1的SRAM芯片组成64K×8的存储器，需要8个芯片。
位扩展的连接方式是将各存储芯片的地址线、片选线和读/写线相应地并联起来，而将各芯片的数据线单独列出

2.字扩展
      字扩展是指仅在字数方向扩展，而位数不变。
      如用16K×8的SRAM组成64K×8的存储器，需要4个芯片。
字扩展将芯片的地址线、数据线、读/写线并联，由片选信号来区分各个芯片。

3.字和位同时扩展
      当构成一个容量较大的存储器时，往往需要在字数方向和位数方向上同时扩展。
      如用16K×4的SRAM组成64K×8的存储器，需要8个芯片。
CPU要实现对存储单元的访问，首先要选择存储芯片，即进行片选；然后再从选中的芯片中依地址码选择出相应的存储单元，以进行数据的存取，这称为字选。
     

5.4.2 存储芯片的地址分配和片选
片内的字选是由CPU送出的N条低位地址线完成的，地址线直接接到所有存储芯片的地址输入端（N由片内存储容量2N 决定），
片选信号则是通过高位地址得到的。

实现片选的方法:
线选法
全译码法
部分译码法。





	
