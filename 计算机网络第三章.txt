第三章 数据链路层
（1）点对点信道。这种信道使用一对一的点对点通信方式。
（2）广播信道。这种信道使用一对多的广播通信方式。

3.1 使用点对点信道的数据链路层
（1）链路（link）就是从一个结点到相邻结点的一段物理线路，而中间没有任何其他交换结点。
（2）数据链路（data link）：当需要在一条线路上传送数据时，除了必须有一条物理线路外，还必须有一些必要的通信协议来控制这些数据的传输。把实现这些协议的硬件和软件加到链路上，就构成了数据链路。
（3）使用网络适配器（网卡）来实现这些协议。一般的适配器都包括了数据链路层和物理层这两层的功能。
（4）数据链路层的协议数据单元——帧
（5）点对点信道的数据链路层在进行通信时的步骤：
	（1）结点A的数据链路层把网络层交下来的IP数据报添加首部和尾部封装成帧。
	（2）结点A把封装好的帧发送给结点B的数据链路层。
	（3）结点B的数据链路层收到的帧无差错，则从收到的帧中提取出IP数据报上交给上面的网络层；否则丢弃这个帧。



3.12 三个基本问题
（1）封装成帧
（2）透明传输
（3）差错检测

一：
  （1）封装成帧：在一段数据的前后分别添加首部和尾部，就构成了一个帧。
  （2）首部和尾部的一个重要作用就是进行帧定界。（还包括许多必要的控制信息）
  
  （3）数据部分长度上限--最大传送单元MTU（Maximum Transfer Unit）

（4）帧定界符。（数据是可打印的ASCLL码组成的文本文件）
SOH（start of head）帧的首部开始
EOT（End of transmission）帧的结束
（5）由于使用了帧的定界符，接收端可以判断有无明确的帧定界符来选择是否丢弃这一帧。
二：
（1）透明传输：不管从键盘上输入什么字符都可以放在这样的帧中传输过去。（无论什么样的比特组合的数据都能够通过这个数据链路层。）
（2）解决透明问题。字节填充/字符填充：发送端需要在数据中出现控制字符“SOH”“EOT”前加上ESC（接收端在的数据链路层把数据送往网络层以前删除这个转义字符）。
三：
（1）差错检测：传输过程中可能会产生比特差错：1 可能会变成 0 而 0 也可能变成 1。
在一段时间内，传输错误的比特占所传输比特总数的比率称为误码率 BER (Bit Error Rate)。
误码率与信噪比有很大的关系。
为了保证数据传输的可靠性，在计算机网络传输数据时，必须采用各种差错检测措施。

（2）循环冗余检验（CRC）
（3）模2运算
（4）FCS 冗余码
（5）经过模2运算得到的余数R
	if(R==0){
	printf（“运算无误”）；}

	else{
	printf（“这个帧有误，丢弃”）；


}
（6）仅用循环冗余检验 CRC 差错检测技术只能做到无差错接受(accept)。
（7）帧丢失 帧重复 帧失序
（8）OSI/RM模型的观点：数据链路层要做成无传输差错的！但这种理念目前不被接受！





3.2 点对点协议PPP
（1）PPP协议特点：因特网用户通常都要连接到某个ISP才能接入到因特网。PPP协议就是用户计算机和ISP进行通信时，所用的数据链路层协议。用户使用拨号电话线接入因特网时，一般都是使用 PPP 协议。

（2）PPP协议应该满足的需求
	1.简单
	2.封装成帧
	3.透明性
	4.多种网络层协议
	5.多种类型链路
	6.差错检测
	7.检测连接状态
	8.最大传输单元
	9.网络层地址协商
	10.数据压缩协商


3.2.2  PPP协议的帧格式
一：
各字段的意义
图在课本75页
标志字段：规定为0x7E。表示一个帧的开始和结束。
标志字段就是PPP帧的定界符。
PPP 是面向字节的，所有的 PPP 帧的长度都是整数字节。

二：
字节填充
信息字段出现和标志字段一样的比特组合。
转义字符定为：0x7D
（1）把信息字段出现的每一个0x7E字节转成2个字节（0x7D,0x5E）
（2）把信息字段出现的每一个0x7D变成2个字节（0x7D,0x5D）
（3）看课本。P76
三：
零比特填充
（1）PPP协议在使用同步传输是，采用零比特填充实现透明传输
（2）做法：只要发现有5个连续1，则立即填入一个0
（3）
	1.在数据链路层出现差错的概率不大时，使用比较简单的 PPP 协议较为合理。
	2.在因特网环境下，PPP 的信息字段放入的数据是 IP 数据报。数据链路层的可靠传输并不能够保证网络层的传输也是可靠的。
	3.帧检验序列 FCS 字段可保证无差错接受。






3.3使用广播信道的数据链路层
（1）局域网最主要特点：网络为一个单位所拥有，且地理范围和站点数目均有限。
（2）以太网采用的协议是CSMA/CD。意思是载波监听多点接入/碰撞检测。
	1.“多点接入”表示许多计算机以多点接入的方式连接在一根总线上。
	2.“载波监听”是指每一个站在发送数据之前先要检测一下总线上是否有其他计算机在发送数据，如果有，则暂时不要发送数据，以免发生碰撞。 “载波监听”就是用电子技术检测总线上有没有其他计算机发送的数据信号。
	3.“碰撞检测”就是计算机边发送数据边检测信道上的信号电压大小
	4.检测到碰撞后
		*在发生碰撞时，总线上传输的信号产生了严重的失真，无法从中恢复出有用的信息来。
		*每一个正在发送数据的站，一旦发现总线上出现了碰撞，就要立即停止发送，免得继续浪费网络资源，然后等待一段随机时间后再次发送。


（3）单工程端到端的传播时延记为 “字母tao”
（4）以太网的端到端的争用期为2tao
（5）经过争用期还未检测到碰撞，才肯定这次不会发生碰撞。
（6）最短帧长：(传播时延*2)*数据率
（7）静态划分信道	
	频分复用
	时分复用
	波分复用
	码分复用 
（8）最初的以太网是将许多计算机都连接到一根总线上。当初认为这样的连接方法既简单又可靠，因为总线上没有有源器件。 
（9）总线上的每一个工作的计算机都能检测到 B 发送的数据信号。 
由于只有计算机 D 的地址与数据帧首部写入的地址一致，因此只有 D 才接收这个数据帧。 
具有广播特性的总线上实现了一对一的通信。



3.4使用广播信道的以太网
1.1990年IEEE制定出星形以太网10BASE-T的标准802.3i。“10”代表10Mb/s的数据率，BASE表示连接线上的信号是基带信号，T代表双绞线。
2.10BASE-T的以太网的通信距离稍短，每个站到集线器的距离不超过100m。
3.（1）使用集线器的以太网在逻辑上仍是一个总线型网络，各站共享逻辑上的总线，使用的还是CSMA/CD协议。
（2）一个集线器有许多接口。
（3）集线器工作在物理层，每个接口仅仅简单的转发比特，不进行碰撞检测。
4.以太网发送的数据都使用曼彻斯特编码。
曼彻斯特编码：以半个符号宽的先负后正（1、0）的脉冲代表数字信号1
半个符号的先正后负的脉冲（0、1）代表数字信号0。目前最广泛应用的以太局域网，在数据传输时就采用这种数字编码方式。
5.要提高以太网的信道利用率，就必须减小tao与 T0 之比。在以太网中定义了参数 a，它是以太网单程端到端时延tao与帧的发送时间T0之比。
（1）a→0 表示一发生碰撞就立即可以检测出来，并立即停止发送，因而信道利用率很高。
（2）a 越大，表明争用期所占的比例增大，每发生一次碰撞就浪费许多
6.（1）信道资源，使得信道利用率明显降低。 
当数据率一定时，以太网的连线的长度受到限制，否则 ? 的数值会太大
（2）以太网的帧长不能太短，否则 T0 的值会太小，使 a 值太大。
7.理想情况下的极限信道利用率 Smax为TO/TO+tao=1/1+a
8.在局域网中，硬件地址又称为物理地址，或 MAC 地址。48位 
9.适配器从网络上每收到一个 MAC 帧就首先用硬件检查 MAC 帧中的 MAC 地址.
	如果是发往本站的帧则收下，然后再进行其他的处理。
	否则就将此帧丢弃，不再进行其他的处理。
10.
发往本站的帧”包括以下三种帧： 
	单播(unicast)帧（一对一）
	广播(broadcast)帧（一对全体）
	多播(multicast)帧（一对多）
11.常用的以太网MAC帧格式有两种标准 ：
	DIX Ethernet V2 标准
	IEEE 的 802.3 标准
12.MAC帧的形式
	（1）目的地址字段 6 字节
	（2）源地址字段 6 字节
	（3）类型字段 2 字节（标志上一层是什么协议以便把收到的 MAC 帧的数据上交给上一层的这个协议。）
	（4）数据字段 46 ~ 1500 字节
	数据字段的正式名称是 MAC 客户数据字段
最小长度 64 字节-18 字节的首部和尾部 = 数据字段的最小长度
  	（5）FCS 字段 4 字节
	当数据字段的长度小于 46 字节时，应在数据字段的后面加入整数字节的填充字段，以保证以太网的 MAC 帧长不小于 64 字节。
	（6）在帧的前面插入的 8 字节中的第一个字段共 7 个字节，是前同步码，用来迅速实现 MAC 帧的比特同步。第二个字段是帧开始定界符，表示后面的信息就是MAC 帧。 
13.无效的 MAC 帧 
（1）帧的长度不是整数个字节；
（2）用收到的帧检验序列 FCS 查出有差错；
（3）数据字段的长度不在 46 ~ 1500 字节之间。
（4）有效的 MAC 帧长度为 64 ~ 1518 字节之间。
（5）对于检查出的无效 MAC 帧就简单地丢弃。以太网不负责重传丢弃的帧。 


	



	
	








































































































